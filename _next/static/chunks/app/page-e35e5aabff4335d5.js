(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7839:function(e,a,t){Promise.resolve().then(t.bind(t,5270))},5270:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return page}});var r=t(7437),i=t(5510);async function updateGoogleSpreadsheet(e){try{let a=await fetch("https://script.google.com/macros/s/AKfycbzkPu9mFosYhPNC_G9bHt9Jzn7LSEXXK24e9hQqY42o8bQZ6eRzmiYFHuUVzCttC9HtIA/exec",{method:"POST",body:JSON.stringify(e)}),t=await a.json();if(console.debug("res: ",t,", response: ",a),!t||!t.success)throw Error("invalid response");return!0}catch(e){console.error("Error updating data:",e)}return!1}async function fetchDataFromGoogleAppsScript(){try{let e=await fetch("https://script.google.com/macros/s/AKfycbzkPu9mFosYhPNC_G9bHt9Jzn7LSEXXK24e9hQqY42o8bQZ6eRzmiYFHuUVzCttC9HtIA/exec"),a=await e.json(),t=Array.isArray(a)?a.filter(isPost):[];return t}catch(e){console.error("Error fetching data:",e)}return[]}function isPost(e){return isOptionalBoolean(e.asiste)&&isOptionalBoolean(e.celiaco)&&isOptionalBoolean(e.vegetariano)&&!isNaN(e.familia)&&"string"==typeof e.nombre}function isOptionalBoolean(e){return"string"==typeof e&&(!e||["si","no"].includes(e))}var n=t(2265),app_useData=function(){let[e,a]=(0,n.useState)(!1),[t,r]=(0,n.useState)(!1),[i,l]=(0,n.useState)(!0),[s,o]=(0,n.useState)([]);(0,n.useEffect)(()=>{!async function(){let e=await fetchDataFromGoogleAppsScript();o(e),l(!1)}()},[]);let c=(0,n.useCallback)(async e=>{l(!0);let t=await updateGoogleSpreadsheet(e);t?r(!0):a(!0),l(!1)},[]);return{loading:i,success:t,error:e,data:s,save:c}},page=function(){let{data:e,loading:a,error:t,success:l,save:s}=app_useData(),[o,c]=(0,n.useState)(""),[d,g]=(0,n.useState)(!1),[u,b]=(0,n.useState)([]),f=o?e.find(e=>e.nombre===o).familia:null;function toggleValue(e,a){let t=u.map(t=>t.nombre===a.nombre?{...a,[e]:"si"===t[e]?"no":"si"}:t);b(t)}async function confirm(){g(!1),await s(u)}(0,n.useEffect)(()=>{if(f){let a=getFamily(e,f);b(a)}else b([])},[e,f]);let p=f?getFamily(e,f):[],m=!!(p.length===u.length&&u.find(e=>p.find(a=>a.nombre===e.nombre&&("".concat(a.asiste)!=="".concat(e.asiste)||"".concat(a.celiaco)!=="".concat(e.celiaco)||"".concat(a.vegetariano)!=="".concat(e.vegetariano)))));return(0,r.jsxs)("main",{className:"flex min-h-screen flex-col items-center justify-center p-24 gap-20",children:[(0,r.jsx)("div",{className:"items-center justify-between font-mono text-sm lg:flex",children:(0,r.jsx)("p",{className:"flex w-full justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30",children:(0,r.jsx)("code",{className:"font-mono font-bold",children:l?"GRACIAS POR CONFIRMAR TU ASISTENCIA":t?"HUBO UN ERROR AL INTENTAR GUARDAR LOS DATOS, POR FAVOR MANDALE UN MENSAJE DE WHATSAPP A GISE":"Confirm\xe1 tu asistencia en el cumple de 15 de MARTU"})})}),a&&(0,r.jsx)("p",{className:"flex w-full justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30",children:(0,r.jsx)("code",{className:"font-mono font-bold",children:"Cargando..."})}),!a&&!d&&!l&&!t&&(0,r.jsxs)(r.Fragment,{children:[!!e.length&&(0,r.jsx)("div",{className:"relative flex place-items-center",children:(0,r.jsx)(i.ZP,{className:"basic-single",onChange:e=>c((null==e?void 0:e.value)||""),styles:{input:e=>({...e,minWidth:"200px"}),menu:e=>({...e,color:"black"})},options:e.map(e=>({value:e.nombre,label:e.nombre}))})}),o&&(0,r.jsx)("button",{className:"flex w-full justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30",onClick:()=>g(!0),children:"CONFIRMAR ASISTENCIA"})]}),!a&&d&&!l&&!t&&(0,r.jsxs)("div",{className:"flex flex-col justify-start gap-2",children:[u.map((e,a)=>(0,r.jsxs)("div",{className:"flex flex-row justify-between gap-8 border-b border-gray-300 bg-gradient-to-b pt-4 pb-4",children:[(0,r.jsx)("div",{children:(0,r.jsx)("label",{children:e.nombre})}),(0,r.jsxs)("div",{className:"flex flex-row justify-evenly gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col justify-start gap-2",children:[(0,r.jsx)("div",{children:(0,r.jsx)("label",{children:"Asistir\xe1"})}),(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"checkbox",id:"asistira",value:e.asiste,checked:"si"===e.asiste,onChange:()=>toggleValue("asiste",e)})})]}),(0,r.jsxs)("div",{className:"flex flex-col justify-start gap-2",children:[(0,r.jsx)("div",{children:(0,r.jsx)("label",{children:"Vegetariano"})}),(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"checkbox",id:"vegetariano",disabled:"si"!==e.asiste,value:e.vegetariano,checked:"si"===e.vegetariano,onChange:()=>toggleValue("vegetariano",e)})})]}),(0,r.jsxs)("div",{className:"flex flex-col justify-start gap-2",children:[(0,r.jsx)("div",{children:(0,r.jsx)("label",{children:"Sin TACC"})}),(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"checkbox",id:"sintacc",disabled:"si"!==e.asiste,value:e.celiaco,checked:"si"===e.celiaco,onChange:()=>toggleValue("celiaco",e)})})]})]})]},"".concat(e.nombre,"-").concat(a))),(0,r.jsx)("button",{disabled:!m,className:"flex w-full justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30",onClick:confirm,children:"CONFIRMAR"})]})]})};function getFamily(e,a){return e.filter(e=>e.familia===a).map(mapFamily)}function mapFamily(e){return{...e,asiste:e.asiste?e.asiste:"no",celiaco:e.celiaco?e.celiaco:"no",vegetariano:e.vegetariano?e.vegetariano:"no"}}}},function(e){e.O(0,[878,971,864,744],function(){return e(e.s=7839)}),_N_E=e.O()}]);